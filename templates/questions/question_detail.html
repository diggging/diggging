{% extends 'questions/base.html' %}
{% load static %}
{% block content %}
<div class="question_container">
    {% if post.image %}
    <img src="{{ post.image.url }}" class="thumbnail_area">
    {% endif %}
    <div class="post_container">
        <!-- ì œëª©ì˜ì—­ -->
        <div class="post_top">
            <div class="title_area">
                <h1>{{post.title}}</h1>
                <div class="post_user_info">
                    <img src="{{post.user.user_profile_image.url}}">
                    <h3>{{ post.user.user_nickname }}ë‹˜ì˜ ì§ˆë¬¸</h3>
                </div>
            </div>
            {% if request.user.id == post.user.id %}
            <div class="auth_btn_area">
                <div class="edit_btn">
                    <a href="{% url 'question:question_update' post.id %}">ìˆ˜ì •í•˜ê¸°</a>
                </div>
                <div class="delete_btn">
                    <a href="{% url 'question:question_delete' post.id %}">ì‚­ì œí•˜ê¸°</a>
                </div>
            </div>
            {% endif %}
        </div>
        <!-- ì œëª©ì˜ì—­ ë -->
        <div class="category_area">
            <span class="post_language">ì–¸ì–´|{{post.language}}</span>
            <span class="post_framework">í”„ë ˆì„ì›Œí¬|{{post.framework}}</span>
            <span class="post_os">ìš´ì˜ì²´ì œ|{{post.os}}</span>
            <div class="post_os">ì—ëŸ¬ë©”ì‹œì§€|{{post.error_message}}</div>
        </div>
        <div class="desc_area">
            {{ post.desc|safe|escape }}
        </div>
        {% if not request.user.id == post.user.id %}
        <div class="post_{{post.id}}">
            <div>
                <input type="button" class="like" name="{{ post.id }}" value="Like" style="margin-top: 7px">
                <button id="count-{{ post.id }}" style="font:bold 1em; margin-top: 3px">
                    ë„ì›€ì´ë˜ì—ˆì–´ìš”.{{ post.likes_user.all.count }}ê°œ</button>
            </div>
        </div>
        {% endif %}
        <div class="accordion_area">
            <button class="btn btn_toggle">ê³µìœ í•˜ê¸°</button>
            <div class="content_area">
                <span class="sociallink ml-1">
                    <a href="javascript:sendLinkFacebook()" title="í˜ì´ìŠ¤ë¶ìœ¼ë¡œ ê³µìœ ">
                    <img src="{% static 'images/facebook.png' %}" width=36 alt="Facebook">
                    </a>
                </span>
                <span class="sociallink ml-1">
                    <a href="javascript:sendLinkTwitter()" title="íŠ¸ìœ„í„°ë¡œ ê³µìœ ">
                    <img src="{% static 'images/twitter.png' %}" width=36 alt="Twitter">
                    </a>
                </span>
                <span class="sociallink ml-1">
                    <a href="javascript:sendLinkNaver()" title="ë„¤ì´ë²„ë¡œ ê³µìœ ">
                    <img src="{% static 'images/naver.png' %}" width=36 alt="Naver">
                    </a>
                </span>
                <span class="sociallink ml-1">
                    <a href="javascript:sendLinkKakao()" id="kakao-link-btn" title="ì¹´ì¹´ì˜¤í†¡ìœ¼ë¡œ ê³µìœ ">
                    <img src="{% static 'images/kakaotalk.png' %}" width=36 alt="Kakaotalk"> <!--ì´ê±°ëŠ” ë„ë©”ì¸ì´ì—†ì–´ì„œ ëª»í•˜ëŠ”ì¤‘ì„ë‹¹... ë°°í¬í•˜ë©´ ìˆ˜ì • í•  ì˜ˆì •.-->
                    </a>
                </span>
            </div>
            {% if not request.user.id == post.user.id %}
            <div>
                <input type="button" class="btn btn-info btn-sm scrap" name="{{ post.id }}" value="scrap"
                    style="margin-top: 7px">
                <button id="scarp-{{ post.id }}" style="font:bold 1em; margin-top: 3px">
                    í¼ê°€ê¸°{{ post.scarps_user.all.count }}ê°œ</button>
            </div>
            <div class="scrap_popup" style="opacity: 0;">
                <p>ì–¸ì–´ğŸ“ {{post.language}} í”„ë ˆì„ì›Œí¬ğŸ“ {{post.framework}}ìœ¼ë¡œ í¼ì™”ìŠµë‹ˆë‹¤.
                ë§ˆì´í˜ì´ì§€ì—ì„œ í™•ì¸í•´ë³´ì„¸ìš”!</p>
            </div>
            {% endif %}
        </div>
        <!-- <div class="post_{{post.id}}">
            <a class="like_button post__like" onclick="onClickLikeScrap({{ post.id }}, 'like')">ë„ì›€ì´-ë˜ì—ˆì–´ìš”
                {{post.helped_num}}</a>
            <a href="{% url 'question:get_question' post.id %}" class="post__scrap"
                onclick="onClickLikeScrap({{ post.id }}, 'scrap')">í¼ê°€ê¸° {{post.scrap_num}}</a> -->

        <a href="javascript:doDisplay();" class="comment_btn">ëŒ“ê¸€ {{post.question_comments.count}}ê°œ</a>
        <!-- ì§ˆë¬¸-ëŒ“ê¸€ì°½ ì˜ì—­ -->
        <div id="comment_box">
            <div class='addComment'>
                {% for comment in comments %}
                <div class='comment_id_{{comment.id}}'>
                    <div class="comment_info">
                        <div class="comment_profile">
                            <img src="{{comment.user.user_profile_image.url}}">
                            <span class="user_nicknamme">
                                {{comment.user.user_nickname}}
                            </span>
                        </div>
                        <div class="comment_content">
                            <div class="comment_created">
                                {{comment.created}}
                            </div>
                            <div class="comment_text">
                                {{comment.text}}
                            </div>
                        </div>
                    </div>
                    {% if request.user == comment.user %}
                    <div class="delete_btn">
                        <button onclick="onClickDelete({{post.id}},{{comment.id}})">ì‚­ì œ</button>
                        <!--comment ë³„ë¡œ id ì¤€ë‹¹-->
                    </div>
                    {% endif %}
                </div>
                {% endfor %}
            </div>
            <div class="comment_input_area">
                <input class="comment_input" type="text" placeholder="ëŒ“ê¸€ë‹¬ê¸°" />
                <button class="comment_input_btn" onclick="onClickComment({{ post.id }})">ê²Œì‹œ</button>
            </div>
        </div>
    </div>
    <a href="{% url 'question:answer_create' post.id %}" class="btn_control">ë‹µë³€ ë‚¨ê¸°ê¸°</a>
</div>
<!-- ì§ˆë¬¸-ëŒ“ê¸€ì°½ì˜ì—­ ë -->
<!-- ì§ˆë¬¸ì— ëŒ€í•œ ë‹µë³€ ì˜ì—­ ë‹µë³€ë‹µë³€ë‹µë³€ -->
<div class="answer_area">
    {% if post_answers %}
    {% for answer in post_answers %}
    <div class="answer_container answer-id-{{answer.id}}">
        <div class="post_top">
            <div class="answer_info_box">
                <h3>{{ answer.user.user_nickname }}ë‹˜ì˜ ë‹µë³€</h3>
                <h3>ì±„íƒì—¬ë¶€ : {{answer.selection}}</h3>
                {{answer.title}}
            </div>
            {% if request.user.id == answer.user.id %}
            <div class="auth_btn_area">
                <div class="edit_btn">
                    <a href="{% url 'question:answer_update' post.id answer.id %}">ìˆ˜ì •í•˜ê¸°</a>
                </div>
                <div class="delete_btn">
                    <a href="{% url 'question:answer_delete' post.id answer.id %}">ì‚­ì œí•˜ê¸°</a>
                </div>
            </div>
            {% endif %}
            <!--í•˜ë‚˜ë¼ë„ ì±„íƒë˜ë©´ ì±„íƒ ë²„íŠ¼ ì‚­ì œ ê¸°ëŠ¥-->
            {% if not answer.question.is_selected %}
            {% if request.user.id == post.user.id %}
            {% if answer.selection == False %}
            <div class="choice_btn">
                <button onclick="answerChoicePopup()" value="{{answer.id}}">ì±„íƒí•˜ê¸°</button>
            </div>
            ì±„íƒì•ˆëœ ë‹µë³€
            {% else %}
            {% if answer.selection == True %}
            ì±„íƒë˜ì—ˆì–´ìš”
            {% endif %}
            {% endif %}
            {% endif %}
            <div class="choice_modal_body_{{answer.id}} choice_popup" style="visibility: hidden;">
                <button class="modal_delete_{{answer.id}}">x</button>
                <h3>í•´ë‹¹ ë‹µë³€ì„ ì±„íƒí•˜ì‹œê² ìŠµë‹ˆê¹Œ?</h3>
                <a href="{% url 'question:chosen_answer' answer.id %}" class="yes_choice">ì˜ˆ</a>
                <button class="no_select_{{answer.id}}">ì•„ë‹ˆì˜¤</button>
            </div>
            {% else %}
            {% if answer.selection == True %}
            ì±„íƒë˜ì—ˆì–´ìš”
            {% endif %}
            {% endif %}
        </div>
        <div class="answer_desc_box">
            {{ answer.desc|safe|escape|linebreaks}}
        </div>
        <a href="javascript:doDisplayAnswer({{answer.id}})">ëŒ“ê¸€ {{answer.answer_comments.count}}</a>
        <!-- ë‹µë³€ì˜ ëŒ“ê¸€ì°½ì˜ì—­ -->
        <div id="comment_box{{answer.id}}">
            <div id="answer_comment_box">
                <div class='addAnswerComment'>
                    <div>
                        <input class="answer_comment_input" type="text" placeholder="ëŒ“ê¸€ë‹¬ê¸°" />
                        <button onclick="onClickAnswerComment({{ answer.id }})">ê²Œì‹œ</button>
                        <!--comment ë³„ë¡œ id ì¤€ë‹¹-->
                    </div>
                    <div>
                        {% for comment in answer.answer_comments.all.reverse %}
                        <div class='answer_comment_id_{{comment.id}}'>
                            <div class="answer_comment_text">
                                {{comment.text}}
                            </div>
                            {% if request.user == comment.user %}
                            <div class="add_comment_delete_btn">
                                <button onclick="onClickAnswerCommentDelete({{answer.id}}, {{comment.id}})">ì‚­ì œ</button>
                            </div>
                            {%endif%}
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% endfor %}
    {% endif %}
</div>
{% endblock %}

    {% block script %}
    <link rel="stylesheet" href="{% static 'css/questions/question_detail.css' %}">
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/vs2015.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <!-- <script type="text/javascript">hljs.highlightAll();</script> -->
    <script type="text/javascript">hljs.initHighlightingOnLoad();</script>

    <script type="text/javascript">
        // ë¹ˆ ì½”ë©˜íŠ¸ ê²Œì‹œ ì‹œ ì•ŒëŒì°½ ëœ¨ê²Œ í•  div
        const test = document.querySelector('.addComment');
        const body = document.querySelector('body');
        const nullComment = (input) => {
                const newDiv = document.createElement('div');
                const newText = document.createTextNode('ëŒ“ê¸€ì„ ì…ë ¥í•˜ì„¸ì—¬!!');
                newDiv.appendChild(newText);
                //newDiv ì»¤ìŠ¤í…€
                newDiv.style.width = "100px";
                newDiv.style.height = "30px";
    
                newDiv.setAttribute('class', 'comment_alert');
                
                body.appendChild(newDiv);
                //setTimeout(()=> {
                //    newDiv.remove()
                //}, 2000)
            }
    
        //--------------------------------------------------------------------------------------------------------
         // ì§ˆë¬¸ ì½”ë©˜íŠ¸ ì¶”ê°€ ë¶€ë¶„
        const requestComment = new XMLHttpRequest();
        const commentInput = document.querySelector(`.comment_input`)
    
        const onClickComment = (id) => {
    
            if (!commentInput.value) {
                nullComment(commentInput)
                return false
            } else {
                const url = '/comments/add_question_comment/';
                requestComment.open('POST', url, true);
                requestComment.setRequestHeader(
                    'Content-Type',
                    'application/x-www-form-urlencoded'
                );
                const text = document.querySelector(`.comment_input`).value;
                requestComment.send(JSON.stringify({ id: id, text: text}));
                console.log(requestComment);
            }
        };
        
        const commentHandleResponse = () => {
            if (requestComment.status < 400) {
                const { id } = JSON.parse(requestComment.response);
                const { text } = JSON.parse(requestComment.response);
                const { comment_id } = JSON.parse(requestComment.response);
                const { comment_date } = JSON.parse(requestComment.response);
                const {user} = JSON.parse(requestComment.response);
                
                //ìœ ì € ë°ì´í„° ì§ë ¬í™”
                const userData = JSON.parse(user); 
                const userImg = userData[0].fields.user_profile_image;
                const userImgUrl = userImg.slice(2)
                const userName = userData[0].fields.user_nickname;
                const createDate = comment_date;
    
                const addComment = document.querySelector(`.addComment`);
                console.log(commentInput.value)
                // ì•„ë¬´ê²ƒë„ ì…ë ¥ì•ˆí–ˆì„ ë•Œ, ëŒ“ê¸€ ì•ˆë‹¬ë¦¼
    
                    addComment.innerHTML += `
                    <div class='comment_id_${comment_id}'>
                        <div class="comment_info">
                            <div class="comment_profile">
                                <img src="${userImgUrl}">
                                <span class="user_nicknamme">
                                ${userName}
                                </span>
                            </div>
                            <div class="comment_content">
                                <div class="comment_created">
                                    ${createDate}
                                </div>
                                <div class="comment_text">
                                    ${text}
                                </div>
                            </div>
                        </div>
                        <div class="delete_btn">
                            <button onclick="onClickDelete(${id}, ${comment_id})">ì‚­ì œ</button>
                        </div>
                    </div>
                `
                commentInput.value = null
            };
        };
        requestComment.onreadystatechange = () => {
            if (requestComment.readyState === XMLHttpRequest.DONE) {
                commentHandleResponse();
            };
        };
        //-------------------------------------------------------------------------------------------
       // ì§ˆë¬¸ ì½”ë©˜íŠ¸ ì‚­ì œ ë¶€ë¶„
    const requestDelComment = new XMLHttpRequest();
    const onClickDelete = (id, comment_id) => {
        const url = '/comments/delete_question_comment/';
        requestDelComment.open('POST', url, true);
        requestDelComment.setRequestHeader(
            'Content-Type',
            'application/x-www-form-urlencoded'
        );
        requestDelComment.send(JSON.stringify({ id: id, comment_id: comment_id }));
    };
    const commentdelHandleResponse = () => {
        if (requestDelComment.status < 400) {
            const { id } = JSON.parse(requestDelComment.response);
            const { comment_id } = JSON.parse(requestDelComment.response);
            const element = document.querySelector(`.comment_id_${comment_id}`);
            element.remove();
        };
    };
    requestDelComment.onreadystatechange = () => {
        if (requestDelComment.readyState === XMLHttpRequest.DONE) {
            commentdelHandleResponse();
        };
    };
// <!-- ì§ˆë¬¸ ì½”ë©˜íŠ¸ ë -->
// <!-- ë‹µë³€ ì½”ë©˜íŠ¸ ì‹œì‘ -->
    //------------------------------------------------------------------------------------------------------
    // ë‹µë³€ ì½”ë©˜íŠ¸ ì¶”ê°€ ë¶€ë¶„
    const requestAnswerComment = new XMLHttpRequest();
    const cmt_input = document.querySelector('.answer_comment_input');

    const onClickAnswerComment = (id) => {
        if(!cmt_input.value) {
            nullComment(cmt_input);
            return false
        } else {
            const url = '/comments/add_answer_comment/';
            requestAnswerComment.open('POST', url, true);
            requestAnswerComment.setRequestHeader(
                'Content-Type',
                'application/x-www-form-urlencoded'
            );
            console.log(id)
            const text = document.querySelector(`.answer-id-${id} .answer_comment_input`).value

            requestAnswerComment.send(JSON.stringify({ id: id, text: text }));
        }
    };
    const AnswercommentHandleResponse = () => {
        if (requestComment.status < 400) {
            const { id } = JSON.parse(requestAnswerComment.response);
            const { text } = JSON.parse(requestAnswerComment.response);
            const { comment_id } = JSON.parse(requestAnswerComment.response);
            const { comment_date } = JSON.parse(requestAnswerComment.response);
            const { user } = JSON.parse(requestAnswerComment.response);
            
            //ìœ ì € ë°ì´í„°
            const userData = JSON.parse(user); 
            console.log(userData)
            const userImg = userData[0].fields.user_profile_image;
            //ì´ê±° ì„¸ê°œ ì‚¬ìš©í•˜ë©´ ë¼!
            const userImgUrl = userImg.slice(2)
            const userName = userData[0].fields.user_nickname;
            const createDate = comment_date;
            
            const addAnswerComment = document.querySelector(`.answer-id-${id} .addAnswerComment`);
            const comment_profile = document.querySelector(`.comment_profile`);
            // ì½”ë©˜íŠ¸ ì‘ì„±ìì˜ í”„ë¡œí•„ ì‚¬ì§„ì„ ë°›ì•„ì™€ì•¼í•¨
            
            // if answer.í”„ë¡œí•„ì‚¬ì§„ ìˆìœ¼ë©´
            // comment_profile.innerHTML = `
            // <div>
            //ì½”ë©˜íŠ¸ ì‘ì„±ìì˜ ë‹‰ë„¤ì„ì´
            if (cmt_input.value === "") {
                nullComment(cmt_input)
                return
            } else {
                addAnswerComment.innerHTML += `
            <div class='answer_comment_id_${comment_id}'>
                <div class="comment_info">
                    <div class="comment_profile">
                        <img src="${userImgUrl}">
                            ${userName}
                            ${createDate}
                <div class="answer_comment_text">
                    ${text}
                </div>
                <div class="answer_comment_delete_btn">
                    <button onclick="onClickAnswerCommentDelete(${id}, ${comment_id})">ì‚­ì œ</button>
                </div>
            </div>
            `
            }
            cmt_input.value = ''
        }

    };
    requestAnswerComment.onreadystatechange = () => {
        if (requestAnswerComment.readyState === XMLHttpRequest.DONE) {
            AnswercommentHandleResponse();
        }
    };

    /*------------------------------------------------------------------------------------------------*/
    // ë‹µë³€ ì½”ë©˜íŠ¸ ì‚­ì œ ë¶€ë¶„
    const requestDelAnswerComment = new XMLHttpRequest();

    const onClickAnswerCommentDelete = (id, comment_id) => {
        const url = '/comments/delete_answer_comment/';
        requestDelAnswerComment.open('POST', url, true);
        requestDelAnswerComment.setRequestHeader(
            'Content-Type',
            'application/x-www-form-urlencoded'
        );
        requestDelAnswerComment.send(JSON.stringify({ id: id, comment_id: comment_id }));
    };
    const AnswerCommentDelHandleResponse = () => {
        if (requestDelAnswerComment.status < 400) {
            const { id } = JSON.parse(requestDelAnswerComment.response);
            const { comment_id } = JSON.parse(requestDelAnswerComment.response);
            const element = document.querySelector(`.answer_comment_id_${comment_id}`);
            console.log(element)
            element.remove();
        };
    };
    requestDelAnswerComment.onreadystatechange = () => {
        if (requestDelAnswerComment.readyState === XMLHttpRequest.DONE) {
            AnswerCommentDelHandleResponse();
        };
    };


    function doDisplay() {
        var commentBox = document.getElementById("comment_box");
        if (commentBox.style.display == 'none') {
            commentBox.style.display = 'block';
        } else {
            commentBox.style.display = 'none';
        }
    }
    function doDisplayAnswer(id) {
        var boxName = "comment_box"+String(id);
        var commentBox = document.getElementById(boxName);
        if (commentBox.style.display == 'none') {
            commentBox.style.display = 'block';
        } else {
            commentBox.style.display = 'none';
        }
    }

        // <!-- ì¢‹ì•„ìš” , ìŠ¤í¬ë© ë²„íŠ¼ ë°”ë€ê²ƒ -->

        // function sendLinkFacebook(){
        // var facebook_share_url = "https://www.facebook.com/sharer/sharer.php?u={{ request.build_absolute_uri }}";
        // window.open(facebook_share_url,
        //             'Share on Facebook',
        //             'scrollbars=no, width=500, height=500');
        // }    
        // function sendLinkTwitter(){
        //     var twitter_share_text="{{ post.title }}";
        //     var twitter_share_url="{{ request.build_absolute_uri }}";
        //     window.open("https://twitter.com/share?text="+twitter_share_text+"&url="+twitter_share_url,
        //                 'Share on Twitter',
        //                 'scrollbars=no, width=500, height=500');
        // }
        // function sendLinkNaver(){
        //     var raw_url = "{{ request.build_absolute_uri }}";
        //     var raw_title = "{{ post.title }}"
        //     var naver_root_url = "http://share.naver.com/web/shareView.nhn?url="
        //     var naver_share_url = naver_root_url+encodeURI(raw_url)+"&title="+encodeURI(raw_title);
        //     window.open(naver_share_url,
        //                 'Share on Naver',
        //                 'scrollbars=no, width=500, height=500');    
        // }


        $(".like").click(function () {
            var pk = $(this).attr('name')
            console.log(".like")
            $.ajax({ // ajaxë¡œ ì„œë²„ì™€ í†µì‹  \
                type: "POST", // ë°ì´í„°ë¥¼ ì „ì†¡í•˜ëŠ” ë°©ë²• \
                url: "{% url 'question:question_like' %}", // í†µì‹ í•  urlì„ ì§€ì • 
                data: { 'pk': pk, 'csrfmiddlewaretoken': '{{ csrf_token }}' }, // ì„œë²„ë¡œ ë°ì´í„° ì „ì†¡ì‹œ ì˜µì…˜, pkë¥¼ ë„˜ê²¨ì•¼ ì–´ë–¤ postì¸ì§€ ì•Œ ìˆ˜ ìˆìŒ
                dataType: "json",
                success: function (response) { // ì„±ê³µ;
                    $("#count-" + pk).html("ë„ì›€ì´ë˜ì—ˆì–´ìš”" + response.likes_count + "ê°œ"); // ì¢‹ì•„ìš” ê°œìˆ˜ ë³€ê²½
                },
                error: function (request, status, error) { // ì‹¤íŒ¨
                    window.location.replace('/users/login')// ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë„˜ì–´ê°€ê¸°
                },
            });
        })

        $(".scrap").click(function () { // .scarp ë²„íŠ¼ì„ í´ë¦­ ê°ì§€
            var pk = $(this).attr('name')
            $.ajax({ // ajaxë¡œ ì„œë²„ì™€ í†µì‹  \
                type: "POST", // ë°ì´í„°ë¥¼ ì „ì†¡í•˜ëŠ” ë°©ë²• \
                url: "{% url 'question:question_scrap' %}", // í†µì‹ í•  urlì„ ì§€ì • 
                data: { 'pk': pk, 'csrfmiddlewaretoken': '{{ csrf_token }}' }, // ì„œë²„ë¡œ ë°ì´í„° ì „ì†¡ì‹œ ì˜µì…˜, pkë¥¼ ë„˜ê²¨ì•¼ ì–´ë–¤ postì¸ì§€ ì•Œ ìˆ˜ ìˆìŒ
                dataType: "json",
                success: function (response) { // ì„±ê³µ;
                    $("#scarp-" + pk).html("í¼ê°€ê¸°" + response.scarps_count + "ê°œ"); // ì¢‹ì•„ìš” ê°œìˆ˜ ë³€ê²½
                },
                error: function (request, status, error) { // ì‹¤íŒ¨
                    window.location.replace('/users/login')// ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë„˜ì–´ê°€ê¸°
                },
            });
        })


        // ì±„íƒíŒì—…
        // let answers = {{post_answers|safe}};
        
        const answerChoicePopup = () => {

            const answers = {{ answers| safe }};
            console.log(answers);
            let body = document.querySelector('body');

            for (answer_id in answers) {
                // let answerChoicePopup = document.querySelector(`.choice_btn_${answer_id}`);
                let modalBody = document.querySelector(`.choice_modal_body_${answer_id}`);
                let modalDelete = document.querySelector(`.modal_delete_${answer_id}`);
                let noSelect = document.querySelector(`.no_select_${answer_id}`);
            
                if (modalBody.style.visibility === "hidden") {
                    modalBody.style.visibility = "visible"
                    modalBody.style.opacity = "1"
                } else {
                    modalBody.style.visibility = "hidden"
                    modalBody.style.opacity = "0"
                };
                
                modalDelete.addEventListener('click', () => {
                    modalBody.style.visibility = "hidden";
                    modalBody.style.opacity = "0"
                });
        
                noSelect.addEventListener('click', () => {
                    modalBody.style.visibility = "hidden";
                    modalBody.style.opacity = "0"
                });
            };
        }
// -------------------------------í¼ì˜¤ê¸° ëˆŒë €ì„ ë•Œ ì•Œë¦¼ì°½------------------     
const scrapPopup = document.querySelector('.scrap_popup')
const scrapButton = document.querySelector('.scrap');

scrapButton.addEventListener('click', () => {
    if (scrapPopup.style.opacity === "0") {
        scrapPopup.style.opacity = "1";
        scrapPopup.style.visibility = "visibile";
    } else {
        scrapPopup.style.opacity = "0"
    }
});

scrapPopup.addEventListener('click', () => {
    scrapPopup.style.opacity = "0";
    scrapPopup.style.visibility = "hidden";
})
</script>
{% endblock script %}